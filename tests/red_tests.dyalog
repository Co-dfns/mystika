:Namespace red_tests

⎕IO ⎕ML ⎕WX←0 1 3

X←{⊢#.UT.expect←⍵} ⋄ M←#.mystika 

RED∆01_TEST←{_←X  16⍪0⍪0⍪(8⍴16)⊤14950715 ⋄ M.add M.red 16⍪0⍪0⍪(8⍴16)⊤2906258 11575550 222852 246055}
RED∆02_TEST←{_←X  16⍪0⍪0⍪(8⍴16)⊤14950715 ⋄ M.sub M.red 16⍪0⍪0 1 0 1⍪(8⍴16)⊤2906258 ¯11575550 222852 ¯246055}
RED∆03_TEST←{_←X  16⍪0⍪1⍪(8⍴16)⊤¯8692495 ⋄ M.add M.red 16⍪0⍪0 1 0 1⍪(8⍴16)⊤2906258 ¯11575550 222852 ¯246055}
RED∆04_TEST←{_←X  16⍪0⍪1⍪(8⍴16)⊤¯8692495 ⋄ M.sub M.red 16⍪0⍪0⍪(8⍴16)⊤2906258 11575550 222852 246055}
RED∆05_TEST←{_←X  16⍪0⍪0⍪(8⍴16)⊤675108 ⋄ M.mul M.red 16⍪0⍪0⍪(8⍴16)⊤188 63 57}
RED∆06_TEST←{_←X  16⍪0⍪0⍪(8⍴16)⊤6×173 ⋄ M.add M.red 16⍪0⍪0⍪(8⍴16)⊤6⍴173}
RED∆07_TEST←{_←X  16⍪0⍪0⍪(8⍴16)⊤11*7 ⋄ M.mul M.red 16⍪0⍪0⍪(8⍴16)⊤7⍴11}
RED∆08_TEST←{_←X  16⍪0⍪0⍪(8⍴16)⊤179 361 ⋄ M.add M.red 16⍪0⍪0⍪(8⍴16)⊤2 3⍴34 100 45 212 55 94}
RED∆09_TEST←{_←X  16⍪0⍪0⍪(8⍴16)⊤153000 1096040 ⋄ M.mul M.red 16⍪0⍪0⍪(8⍴16)⊤2 3⍴34 100 45 212 55 94}
RED∆10_TEST←{_←X  65552 0 0,32↑16,⍨22⍴15 ⋄ M.add M.red 65552⍪0⍪0⍪0,15,⍪¯32↑1}
RED∆11_TEST←{_←X  65552 0 0,32↑0 ⋄ M.add M.red 65552⍪0⍪0 1 0⍪0,15,⍪¯32↑1}
RED∆12_TEST←{_←X  16 ¯1 0,24↑1 ⋄ M.add M.red 16⍪0⍪0⍪0,15,⍪¯24↑1}
RED∆13_TEST←{_←X  16 0 0,24↑0 ⋄ M.add M.red 16⍪0⍪0 1 0⍪0,15,⍪¯24↑1}
RED∆14_TEST←{_←X  0J16⍪0⍪0⍪(8⍴0J16)⊤580J660 ⋄ M.add M.red 0J16⍪0⍪0⍪(8⍴0J16)⊤193J71 153J150 71J88 102J213 61J138}
RED∆15_TEST←{_←X  0J16⍪0⍪0⍪(12⍴0J16)⊤70J¯66 ⋄ M.sub M.red 0J16⍪0⍪0⍪(12⍴0J16)⊤193J71 153J150 71J88 102J213 61J138}
RED∆16_TEST←{_←X  0J16⍪0⍪0⍪(12⍴0J16)⊤¯4027284J¯117237 ⋄ M.mul M.red 0J16⍪0⍪0⍪(12⍴0J16)⊤71J88 102J213 61J138}
RED∆17_TEST←{_←X  10⍪4⍪0⍪(10⍴10)⊤633383 ⋄ M.add M.red 10⍪4 4 3 1 0⍪0⍪(10⍴10)⊤2 81 30 73 56}
RED∆18_TEST←{_←X  10⍪4⍪0⍪(10⍴10)⊤487221 ⋄ M.add M.red 10⍪4 4 3 1 0⍪0 1 0 1 0⍪(10⍴10)⊤2 ¯81 30 ¯73 56}
RED∆19_TEST←{_←X  10⍪¯1⍪0⍪10↑1 2 ⋄ M.add M.red 10⍪0⍪0⍪(10⍴10)⊤6⍴2×10*9}
RED∆20_TEST←{_←X  10⍪¯7⍪0⍪10↑3 2 ⋄ M.mul M.red 10⍪0⍪0⍪(10⍴10)⊤5⍴2×10*3}

:EndNamespace
