:Namespace rop_tests

⎕IO ⎕ML ⎕WX←0 1 3

X←{⊢#.UT.expect←⍵} ⋄ M←#.mystika 

ROP∆01_TEST←{_←X  3 2 1 2⍴(,11)(11 4 3 2 1) ⋄ (16⍪0⍪0⍪(8⍴16)⊤3 2 1⍴⍳6)({(⍴⍺)(⍴⍵)}M.rop ¯4 15)16⍪0⍪0⍪(8⍴16)⊤4 3 2 1⍴⍳24}
ROP∆02_TEST←{_←X  16⍪0⍪0⍪(8⍴16)⊤(5×⍳5)∘.+⍳4 ⋄ (16⍪0⍪0⍪(8⍴16)⊤⍳5)(M.add M.rop ¯1)16⍪0⍪0⍪(8⍴16)⊤5 4⍴⍳20}   
ROP∆03_TEST←{_←X  (3 6 9 13 16)(≥⍤¯1)5 4⍴⍳20 ⋄ (16⍪0⍪0⍪(8⍴16)⊤3 6 9 13 16)(M.geq M.rop ¯1)16⍪0⍪0⍪(8⍴16)⊤5 4⍴⍳20}     
ROP∆04_TEST←{_←X  16⍪0⍪0⍪(8⍴16)⊤(3 2 1⍴⍳6)(+⍤0 15)4 3 2 1⍴⍳24 ⋄ (16⍪0⍪0⍪(8⍴16)⊤3 2 1⍴⍳6)(M.add M.rop 0 15)16⍪0⍪0⍪(8⍴16)⊤4 3 2 1⍴⍳24} 
ROP∆05_TEST←{_←X  (3 2 1⍴⍳6)(≥⍤0 15)4 3 2 1⍴⍳24 ⋄ (16⍪0⍪0⍪(8⍴16)⊤3 2 1⍴⍳6)(M.geq M.rop 0 15)16⍪0⍪0⍪(8⍴16)⊤4 3 2 1⍴⍳24}
ROP∆06_TEST←{_←X  16⍪0⍪0⍪(8⍴16)⊤(3 2 1⍴⍳6)(+⍤3 ¯1)4 3 2 1⍴⍳24 ⋄ (16⍪0⍪0⍪(8⍴16)⊤3 2 1⍴⍳6)(M.add M.rop 3 ¯1)16⍪0⍪0⍪(8⍴16)⊤4 3 2 1⍴⍳24}
ROP∆07_TEST←{_←X  (3 2 1⍴⍳6)(≥⍤3 ¯1)4 3 2 1⍴⍳24 ⋄ (16⍪0⍪0⍪(8⍴16)⊤3 2 1⍴⍳6)(M.geq M.rop 3 ¯1)16⍪0⍪0⍪(8⍴16)⊤4 3 2 1⍴⍳24}
ROP∆08_TEST←{_←X  16⍪0⍪0⍪(8⍴16)⊤(3 2 1⍴⍳6)(+⍤2 ⍤15 ¯2)4 3 2 1⍴⍳24 ⋄ (16⍪0⍪0⍪(8⍴16)⊤3 2 1⍴⍳6)(M.add M.rop 2 M.rop 15 ¯2)16⍪0⍪0⍪(8⍴16)⊤4 3 2 1⍴⍳24}
ROP∆09_TEST←{_←X  (3 2 1⍴⍳6)(≥⍤2 ⍤15 ¯2)4 3 2 1⍴⍳24 ⋄ (16⍪0⍪0⍪(8⍴16)⊤3 2 1⍴⍳6)(M.geq M.rop 2 M.rop 15 ¯2)16⍪0⍪0⍪(8⍴16)⊤4 3 2 1⍴⍳24}
ROP∆10_TEST←{_←X  16⍪0⍪0⍪(8⍴16)⊤(2 1⍴0 5)(+⍤2 ⍤15 2)4 3 2 1⍴⍳24 ⋄ (16⍪0⍪0⍪(8⍴16)⊤2 1⍴0 5)(M.add M.rop 2 M.rop 15 2)16⍪0⍪0⍪(8⍴16)⊤4 3 2 1⍴⍳24}                              
ROP∆11_TEST←{_←X  (2 1⍴0 5)(≥⍤2 ⍤15 2)4 3 2 1⍴⍳24 ⋄ (16⍪0⍪0⍪(8⍴16)⊤2 1⍴0 5)(M.geq M.rop 2 M.rop 15 2)16⍪0⍪0⍪(8⍴16)⊤4 3 2 1⍴⍳24} 
ROP∆12_TEST←{_←X  (16⍪0⍪0⍪(8⍴16)⊤4 3 2 1⍴⍳6) ⋄ (16⍪0⍪0⍪(8⍴16)⊤3 2 1⍴⍳6)({⍺} M.rop 3 ¯1)16⍪0⍪0⍪(8⍴16)⊤4 3 2 1⍴⍳24}                            
ROP∆13_TEST←{_←X  (16⍪0⍪0⍪(8⍴16)⊤4 3 2 1⍴⍳24) ⋄ (16⍪0⍪0⍪(8⍴16)⊤3 2 1⍴⍳6)({⍵} M.rop 3 ¯1)16⍪0⍪0⍪(8⍴16)⊤4 3 2 1⍴⍳24}
ROP∆14_TEST←{_←X  16⍪¨0⍪¨0⍪¨(⊂8⍴16)⊤¨(3 2 1⍴⍳6)({⍺⍵}⍤3 ¯1)4 3 2 1⍴⍳24 ⋄ (16⍪0⍪0⍪(8⍴16)⊤3 2 1⍴⍳6)({⍺⍵} M.rop 3 ¯1)16⍪0⍪0⍪(8⍴16)⊤4 3 2 1⍴⍳24}
ROP∆15_TEST←{_←X  16⍪¨0⍪¨0⍪¨(⊂8⍴16)⊤¨(3 2 1⍴⍳6)({⍺ ⍺ ⍵}⍤3 ¯1)4 3 2 1⍴⍳24 ⋄ (16⍪0⍪0⍪(8⍴16)⊤3 2 1⍴⍳6)({⍺ ⍺ ⍵} M.rop 3 ¯1)16⍪0⍪0⍪(8⍴16)⊤4 3 2 1⍴⍳24}
ROP∆16_TEST←{_←X  16⍪¨0⍪¨0⍪¨(⊂8⍴16)⊤¨(⊂⍤0)4 3 2 1⍴⍳24 ⋄ (⊂ M.rop 0)16⍪0⍪0⍪(8⍴16)⊤4 3 2 1⍴⍳24}
ROP∆17_TEST←{_←X  16⍪¨0⍪¨0⍪¨(⊂8⍴16)⊤¨(⊂⍤1)4 3 2 1⍴⍳24 ⋄ (⊂ M.rop 1)16⍪0⍪0⍪(8⍴16)⊤4 3 2 1⍴⍳24}
ROP∆18_TEST←{_←X  16⍪¨0⍪¨0⍪¨(⊂8⍴16)⊤¨(⊂⍤2)4 3 2 1⍴⍳24 ⋄ (⊂ M.rop 2)16⍪0⍪0⍪(8⍴16)⊤4 3 2 1⍴⍳24}
ROP∆19_TEST←{_←X  16⍪¨0⍪¨0⍪¨(⊂8⍴16)⊤¨(⊂⍤3)4 3 2 1⍴⍳24 ⋄ (⊂ M.rop 3)16⍪0⍪0⍪(8⍴16)⊤4 3 2 1⍴⍳24}
ROP∆20_TEST←{_←X  16⍪¨0⍪¨0⍪¨(⊂8⍴16)⊤¨(⊂⍤¯1)4 3 2 1⍴⍳24 ⋄ (⊂ M.rop ¯1)16⍪0⍪0⍪(8⍴16)⊤4 3 2 1⍴⍳24}
ROP∆21_TEST←{_←X  16⍪¨0⍪¨0⍪¨(⊂8⍴16)⊤¨(⊂⍤¯2)4 3 2 1⍴⍳24 ⋄ (⊂ M.rop ¯2)16⍪0⍪0⍪(8⍴16)⊤4 3 2 1⍴⍳24}
ROP∆22_TEST←{_←X  16⍪¨0⍪¨0⍪¨(⊂8⍴16)⊤¨(⊂⍤¯3)4 3 2 1⍴⍳24 ⋄ (⊂ M.rop ¯3)16⍪0⍪0⍪(8⍴16)⊤4 3 2 1⍴⍳24}

:EndNamespace
                                                   

