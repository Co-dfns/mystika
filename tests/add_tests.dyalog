:Namespace add_tests

⎕IO ⎕ML ⎕WX←0 1 3

X←{⊢#.UT.expect←⍵} ⋄ M←#.mystika 

ADD∆01_TEST←{_←X 16 0 0,(8⍴16)⊤4271680396 ⋄ ⊃M.add/16,¨0,¨0,¨(⊂8⍴16)⊤¨4178339731 93340665}
ADD∆02_TEST←{_←X 16 0 0,(8⍴16)⊤4271680396 ⋄ ⊃M.add/16,¨0,¨0,¨(⊂8⍴16)⊤¨93340665 4178339731}
ADD∆03_TEST←{_←X 16⍪0⍪0⍪(8⍴16)⊤5⍴4271680396 ⋄ ⊃M.add/16⍪¨0⍪¨0⍪¨(⊂8⍴16)⊤¨5⍴¨4178339731 93340665}
ADD∆04_TEST←{_←X 16 0 0,(8⍴16)⊤93340665 ⋄ ⊃M.add/16,¨0,¨0,¨(⊂8⍴16)⊤¨93340665 0}
ADD∆05_TEST←{_←X 16 0 0,(8⍴16)⊤0 ⋄ ⊃M.add/16,¨0,¨0 1,¨(⊂8⍴16)⊤¨93340665 ¯93340665}
ADD∆06_TEST←{_←X 16 0 0,(8⍴16)⊤0 ⋄ ⊃M.add/16,¨0,¨0 1,¨(⊂8⍴16)⊤¨1 ¯1}
ADD∆07_TEST←{_←X 16 0 1,(8⍴16)⊤¯1 ⋄ (11↑16) M.add 16 0 0,¯8↑¯1}
ADD∆08_TEST←{_←X 16 ¯1 0,32⍴1 ⋄ (35↑16) M.add 16 0 0,32⍴16}
ADD∆09_TEST←{_←X 256 0 0,¯8↑4⍴255 ⋄ (256,10↑0) M.add 256,¯10↑¯1+2*32}
ADD∆10_TEST←{_←X 16 0 0,(8⍴16)⊤743669601 ⋄ (16 0 0,(8⍴16)⊤239430974) M.add (16 0 0,(8⍴16)⊤201801714) M.add 16 0 0,(8⍴16)⊤302436913}
ADD∆11_TEST←{_←X 16 0 0,(8⍴16)⊤743669601 ⋄ ((16 0 0,(8⍴16)⊤239430974) M.add (16 0 0,(8⍴16)⊤201801714)) M.add 16 0 0,(8⍴16)⊤302436913}
ADD∆12_TEST←{_←X 16⍪0⍪0⍪(8⍴16)⊤5⍴4271680396 ⋄ (16 0 0,(8⍴16)⊤4178339731) M.add 16⍪0⍪0⍪(8⍴16)⊤5⍴93340665}
ADD∆13_TEST←{_←X 16⍪0⍪0⍪(8⍴16)⊤5⍴4271680396 ⋄ (16⍪0⍪0⍪(8⍴16)⊤5⍴4178339731) M.add 16 0 0,(8⍴16)⊤93340665}
ADD∆14_TEST←{_←X 19↑16 ⋄ (16 0 1,16⍴15) M.add 16,¯18↑1}
ADD∆15_TEST←{_←X 19↑16 ⋄ (16 0 1,16⍴15) M.add 65552,¯18↑1}
ADD∆16_TEST←{_←X 19↑16 ⋄ (65552 0 1,16⍴15) M.add 16,¯18↑1}
ADD∆17_TEST←{_←X 19↑65552 ⋄ (65552 0 1,16⍴15) M.add 65552,¯18↑1}
ADD∆18_TEST←{_←X 19↑16 ¯1 0 1 ⋄ (16 0 0,16⍴15) M.add 16,¯18↑1}
ADD∆19_TEST←{_←X 19↑16 ¯1 0 1 ⋄ (16 0 0,16⍴15) M.add 65552,¯18↑1}
ADD∆20_TEST←{_←X 19↑16 ¯1 0 1 ⋄ (65552 0 0,16⍴15) M.add 16,¯18↑1}
ADD∆21_TEST←{_←X 65552 0 0,16↑16,⍨12⍴15 ⋄ (65552 0 0,16⍴15) M.add 65552 0 0,¯16↑1}
ADD∆22_TEST←{_←X 65546 0 0,20↑10,⍨16⍴9 ⋄ (65546 0 0,20⍴9) M.add 65546 0 0,¯20↑1}
ADD∆23_TEST←{_←X 65545 0 0,20↑9,⍨15⍴8 ⋄ (65545 0 0,20⍴8) M.add 65545 0 0,¯20↑1}
ADD∆24_TEST←{_←X 65539 0 0,40↑3,⍨35⍴2 ⋄ (65539 0 0,40⍴2) M.add 65539 0 0,¯40↑1}
ADD∆25_TEST←{_←X 65538 0 0,40↑2,⍨34⍴1 ⋄ (65538 0 0,40⍴1) M.add 65538 0 0,¯40↑1}
ADD∆26_TEST←{_←X 32⍴1 ⋄ 16≥3↓(65552 0 0,32↑0) M.add 65552 0 0,32⍴¯1+2*32}
ADD∆27_TEST←{_←X 32⍴1 ⋄ 10≥3↓(65546 0 0,32↑0) M.add 65546 0 0,32⍴¯1+2*32}
ADD∆28_TEST←{_←X 32⍴1 ⋄ 9≥3↓(65545 0 0,32↑0) M.add 65545 0 0,32⍴¯1+2*32}
ADD∆29_TEST←{_←X 32⍴1 ⋄ 3≥3↓(65539 0 0,32↑0) M.add 65539 0 0,32⍴¯1+2*32}
ADD∆30_TEST←{_←X 32⍴1 ⋄ 2≥3↓(65538 0 0,32↑0) M.add 65538 0 0,32⍴¯1+2*32}
ADD∆31_TEST←{_←X 65552 0 1,(8⍴16)⊤¯1 ⋄ (11↑65552) M.add 65552,¯10↑¯1}
ADD∆32_TEST←{_←X 16⍴1 ⋄ 0≤3↓ (65552,18↑0) M.add 65552,¯18↑¯2046479980 0 ¯1191477287 0 3392238196 ¯3843241507 0 1225553144}
ADD∆33_TEST←{_←X 0J16 0 0,(8⍴0J16)⊤349J248 ⋄ ⊃M.add/0J16⍪¨0⍪¨0⍪¨(⊂8⍴0J16)⊤¨234J31 115J217}
ADD∆34_TEST←{_←X 0J16 0 0,¯8↑¯1 0J15 ⋄ ⊃M.add/0J16⍪¨0⍪¨0⍪¨(⊂8⍴0J16)⊤¨0J¯1 0}
ADD∆35_TEST←{_←X 0J16 0 0,(8⍴0J16)⊤344J48 ⋄ (16 0 0,(8⍴16)⊤199) M.add 0J16 0 0,(8⍴0J16)⊤145J48}
ADD∆36_TEST←{_←X 0J16 0 0,(8⍴0J16)⊤344J48 ⋄ (0J16 0 0,(8⍴0J16)⊤145J48) M.add 16 0 0,(8⍴16)⊤199}
ADD∆37_TEST←{_←X 10⍪3 4 4 4 4 5 5 5⍪0⍪(8⍴10)⊤⌊(51163÷10*¯3 ¯3 ¯2 ¯1 0 0 1 2)+6979787÷10*1 0 0 0 0 ¯1 ¯1 ¯1  ⋄ (10⍪(⍳8)⍪0⍪(8⍴10)⊤8⍴51163) M.add 10 4 0,(8⍴10)⊤6979787}
ADD∆38_TEST←{_←X 10⍪3 4 4 4 4 5 5 5⍪0⍪(8⍴10)⊤⌊(6979787÷10*1 0 0 0 0 ¯1 ¯1 ¯1)+51163÷10*¯3 ¯3 ¯2 ¯1 0 0 1 2 ⋄ (10 4 0,(8⍴10)⊤6979787) M.add 10⍪(⍳8)⍪0⍪(8⍴10)⊤8⍴51163}
ADD∆39_TEST←{_←X 10 0 1,(8⍴10)⊤¯36478829 ⋄ ⊃M.add/10,¨0,¨0 1,¨(⊂8⍴10)⊤¨60412782 ¯96891611}
ADD∆40_TEST←{_←X 10 0 0,(8⍴10)⊤36478829 ⋄ ⊃M.add/10,¨0,¨1 0,¨(⊂8⍴10)⊤¨¯60412782 96891611}
ADD∆41_TEST←{_←X 10 ¯1 0,(8⍴10)⊤⌊15730439.3 ⋄ ⊃M.add/10,¨0,¨0,¨(⊂8⍴10)⊤¨60412782 96891611}
ADD∆42_TEST←{_←X 10 ¯1 1,(8⍴10)⊤⌊¯15730439.3 ⋄ ⊃M.add/10,¨0,¨1,¨(⊂8⍴10)⊤¨¯60412782 ¯96891611}

:EndNamespace
