:Namespace add_tests

⎕IO ⎕ML ⎕WX←0 1 3

X←{⊢#.UT.expect←⍵} ⋄ M←#.mystika 

ADD∆01_TEST←{_←X 16,(8⍴16)⊤4271680396 ⋄ ⊃M.add/16,¨(⊂8⍴16)⊤¨4178339731 93340665}
ADD∆02_TEST←{_←X 16,(8⍴16)⊤4271680396 ⋄ ⊃M.add/16,¨(⊂8⍴16)⊤¨93340665 4178339731}
ADD∆03_TEST←{_←X 16⍪(8⍴16)⊤5⍴4271680396 ⋄ ⊃M.add/16⍪¨(⊂8⍴16)⊤¨5⍴¨4178339731 93340665}
ADD∆04_TEST←{_←X 16,(8⍴16)⊤93340665 ⋄ ⊃M.add/16,¨(⊂8⍴16)⊤¨93340665 0}
ADD∆05_TEST←{_←X 16,(8⍴16)⊤0 ⋄ ⊃M.add/16,¨(⊂8⍴16)⊤¨93340665 ¯93340665}
ADD∆06_TEST←{_←X 16,(8⍴16)⊤0 ⋄ ⊃M.add/16,¨(⊂8⍴16)⊤¨1 ¯1}
ADD∆07_TEST←{_←X 16,(8⍴16)⊤¯1 ⋄ (16,(8⍴16)⊤0) M.add 16,¯8↑¯1}
ADD∆08_TEST←{_←X 16,0,⍨31⍴1 ⋄ (33↑16) M.add 33⍴16}
ADD∆09_TEST←{_←X 256,¯8↑4⍴255 ⋄ (256,¯8↑0) M.add 256,¯8↑¯1+2*32}
ADD∆10_TEST←{_←X 16,(8⍴16)⊤743669601 ⋄ (16,(8⍴16)⊤239430974) M.add (16,(8⍴16)⊤201801714) M.add 16,(8⍴16)⊤302436913}
ADD∆11_TEST←{_←X 16,(8⍴16)⊤743669601 ⋄ ((16,(8⍴16)⊤239430974) M.add (16,(8⍴16)⊤201801714)) M.add 16,(8⍴16)⊤302436913}
ADD∆12_TEST←{_←X 16⍪(8⍴16)⊤5⍴4271680396 ⋄ (16⍪(8⍴16)⊤4178339731) M.add 16⍪(8⍴16)⊤5⍴93340665}
ADD∆13_TEST←{_←X 16⍪(8⍴16)⊤5⍴4271680396 ⋄ (16⍪(8⍴16)⊤5⍴4178339731) M.add 16⍪(8⍴16)⊤93340665}
ADD∆14_TEST←{_←X 17↑16 ⋄ (16,16⍴15) M.add 65552,¯16↑1}
ADD∆15_TEST←{_←X 17↑16 ⋄ (65552,16⍴15) M.add 16,¯16↑1}
ADD∆16_TEST←{_←X 17↑16 ⋄ (16,16⍴15) M.add 16,¯16↑1}
ADD∆17_TEST←{_←X 65552,16↑16,⍨12⍴15 ⋄ (65552,16⍴15) M.add 65552,¯16↑1}
ADD∆18_TEST←{_←X 65546,20↑10,⍨16⍴9 ⋄ (65546,20⍴9) M.add 65546,¯20↑1}
ADD∆19_TEST←{_←X 65545,20↑9,⍨15⍴8 ⋄ (65545,20⍴8) M.add 65545,¯20↑1}
ADD∆20_TEST←{_←X 65539,40↑3,⍨35⍴2 ⋄ (65539,40⍴2) M.add 65539,¯40↑1}
ADD∆21_TEST←{_←X 65538,40↑2,⍨34⍴1 ⋄ (65538,40⍴1) M.add 65538,¯40↑1}
ADD∆22_TEST←{_←X 32⍴1 ⋄ 16≥1↓(65552,32↑0) M.add 65552,32⍴¯1+2*32}
ADD∆23_TEST←{_←X 32⍴1 ⋄ 10≥1↓(65546,32↑0) M.add 65546,32⍴¯1+2*32}
ADD∆24_TEST←{_←X 32⍴1 ⋄ 9≥1↓(65545,32↑0) M.add 65545,32⍴¯1+2*32}
ADD∆25_TEST←{_←X 32⍴1 ⋄ 3≥1↓(65539,32↑0) M.add 65539,32⍴¯1+2*32}
ADD∆26_TEST←{_←X 32⍴1 ⋄ 2≥1↓(65538,32↑0) M.add 65538,32⍴¯1+2*32}
ADD∆27_TEST←{_←X 65552,(8⍴16)⊤¯1 ⋄ (65552,(8⍴16)⊤0) M.add 65552,¯8↑¯1}
ADD∆28_TEST←{_←X 16⍴1 ⋄ 0≤1↓ (65552,16↑0) M.add 65552,¯16↑¯2046479980 0 ¯1191477287 0 3392238196 ¯3843241507 0 1225553144}

:EndNamespace
